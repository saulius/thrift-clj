<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="thrift-clj : Thrift and Clojure!" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>thrift-clj</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/xsc/thrift-clj">View on GitHub</a>

          <h1 id="project_title">thrift-clj</h1>
          <h2 id="project_tagline">Thrift and Clojure!</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/xsc/thrift-clj/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/xsc/thrift-clj/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h2>Using Thrift from Clojure as if it was Clojure!</h2>

<p><a href="http://thrift.apache.org/">Apache Thrift</a> is an awesome (and terribly documented) framework for server/client interaction. It let's you define types and service functions, creates whole servers and the respective clients in the blink of an eye. However, there currently is no Thrift IDL to Clojure compiler available.</p>

<p><strong>thrift-clj</strong> fills this gap by loading the Java classes generated by the Thrift compiler, making them accessible using plain-and-simple Clojure records and functions.</p>

<h2>Use it!</h2>

<p><strong>Leiningen</strong></p>

<div class="highlight"><pre><span class="p">[</span><span class="nv">thrift-clj</span> <span class="s">"0.1.0"</span><span class="p">]</span>
</pre></div>

<p><strong>Clojure</strong></p>

<div class="highlight"><pre><span class="p">(</span><span class="nf">require</span> <span class="o">'</span><span class="p">[</span><span class="nv">thrift-clj.core</span> <span class="ss">:as</span> <span class="nv">thrift</span><span class="p">])</span>
</pre></div>

<h3>Types</h3>

<div class="highlight"><pre><span class="p">(</span><span class="nf">thrift/import</span> 
  <span class="p">(</span><span class="ss">:types</span> <span class="p">[</span><span class="nv">test.types</span> <span class="nv">Point</span><span class="p">]))</span>

<span class="p">(</span><span class="k">def </span><span class="nv">p</span> <span class="p">(</span><span class="nf">Point.</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">))</span>
<span class="p">(</span><span class="nb">println </span><span class="s">"Point:"</span> <span class="p">(</span><span class="nb">str </span><span class="s">"("</span> <span class="p">(</span><span class="ss">:x</span> <span class="nv">p</span><span class="p">)</span> <span class="s">","</span> <span class="p">(</span><span class="ss">:y</span> <span class="nv">p</span><span class="p">)</span> <span class="s">")"</span><span class="p">))</span>
</pre></div>

<h3>Clients</h3>

<div class="highlight"><pre><span class="p">(</span><span class="nf">thrift/import</span>
  <span class="p">(</span><span class="ss">:types</span> <span class="p">[</span><span class="nv">test.types</span> <span class="nv">Point</span><span class="p">])</span>
  <span class="p">(</span><span class="ss">:clients</span> <span class="p">[</span><span class="nv">test.service.Painter</span> <span class="ss">:as</span> <span class="nv">P</span><span class="p">]))</span>

<span class="p">(</span><span class="nb">with-open </span><span class="p">[</span><span class="nv">c</span> <span class="p">(</span><span class="nf">thrift/connect!</span> <span class="nv">P</span> <span class="s">"localhost:1234"</span> <span class="ss">:protocol</span> <span class="ss">:json</span><span class="p">)]</span>
  <span class="p">(</span><span class="nf">P/drawCircle</span> <span class="nv">c</span> <span class="p">(</span><span class="nf">Point.</span> <span class="mi">10</span> <span class="mi">10</span><span class="p">)</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>

<h3>Services</h3>

<div class="highlight"><pre><span class="p">(</span><span class="nf">thrift/import</span>
  <span class="p">(</span><span class="ss">:services</span> <span class="p">[</span><span class="nv">test.service.Painter</span> <span class="ss">:as</span> <span class="nv">P</span><span class="p">]))</span>

<span class="p">(</span><span class="nf">thrift/defservice</span> <span class="nv">painter</span> <span class="nv">P</span>
  <span class="p">(</span><span class="nf">drawCircle</span> <span class="p">[{</span><span class="ss">:keys</span><span class="p">[</span><span class="nv">x</span> <span class="nv">y</span><span class="p">]}</span> <span class="nv">radius</span><span class="p">]</span>
    <span class="nv">...</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">drawSquare</span> <span class="p">[{</span><span class="ss">:keys</span><span class="p">[</span><span class="nv">x</span> <span class="nv">y</span><span class="p">]}</span> <span class="nv">edge</span><span class="p">]</span>
    <span class="nv">...</span><span class="p">)</span>
  <span class="nv">...</span><span class="p">)</span>

<span class="p">(</span><span class="nf">thrift/serve-and-block!</span>
  <span class="p">(</span><span class="nf">thrift/multi-threaded-server</span> <span class="nv">painter</span> <span class="mi">1234</span> <span class="ss">:protocol</span> <span class="ss">:json</span><span class="p">))</span>
</pre></div>

<p>Have a look at the <a href="https://github.com/xsc/thrift-clj/wiki">Wiki</a> for detailed usage instructions.</p>

<h2>Automatic Thrift Compilation</h2>

<p>If you want to have your Thrift IDL files compiled to Java automatically, have a look at <a href="https://github.com/xsc/lein-thriftc">lein-thriftc</a>!</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">thrift-clj maintained by <a href="https://github.com/xsc">xsc</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
